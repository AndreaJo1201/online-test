<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="goodee.gdj58.online.mapper.TeacherMapper">
	
	<update id="updateTeacherPw"
			parameterType="java.util.Map">
			
			UPDATE teacher
			SET teacher_pw = PASSWORD(#{newPw})
			WHERE teacher_no = #{teacherNo} AND teacher_pw = PASSWORD(#{oldPw})
	</update>
	
	<select id="login"
			resultType="goodee.gdj58.online.vo.Teacher"
			parameterType="goodee.gdj58.online.vo.Teacher">
	
			SELECT
				teacher_no teacherNo
				, teacher_id teacherId
				, teacher_name teacherName
			FROM teacher
			WHERE teacher_id = #{teacherId} AND teacher_pw = PASSWORD(#{teacherPw})
	</select>
	
	<delete id="deleteTeacher"
			parameterType="int">
			
			DELETE
			FROM teacher
			WHERE teacher_no = #{teacherNo}
	</delete>
	
	<insert id="insertTeacher"
			parameterType="goodee.gdj58.online.vo.Teacher">
			
			INSERT INTO teacher (
				teacher_id
				, teacher_pw
				, teacher_name
			) VALUES (
				#{teacherId}
				, PASSWORD(#{teacherPw})
				, #{teacherName}
			)
	</insert>
	
	<select id="selectTeacherListCnt"
			resultType="int"
			parameterType="String">
				
			SELECT
				COUNT(*)
			FROM teacher
			<where>
				<choose>
					<when test="searchCategory == 'name'">
						<if test="searchWord != null and searchWord !=''">
							teacher_name LIKE CONCAT('%',#{searchWord},'%')
						</if>
					</when>
					<when test="searchCategory == 'all'">
						<if test="searchWord != null and searchWord !=''">
							teacher_Id LIKE CONCAT('%',#{searchWord},'%') OR teacher_name LIKE CONCAT('%',#{searchWord},'%')
						</if>
					</when>
					<otherwise>
						<if test="searchWord != null and searchWord !=''">
							teacher_Id LIKE CONCAT('%',#{searchWord},'%')
						</if>
					</otherwise>
				</choose>
			</where>
	</select>
	
	<select id="selectTeacherList"
			resultType="goodee.gdj58.online.vo.Teacher"
			parameterType="java.util.Map">
						
			SELECT
				teacher_no teacherNo
				, teacher_id teacherId
				, teacher_name teacherName
			FROM teacher
			<where>
				<choose>
					<when test="searchCategory == 'name'">
						<if test="searchWord != null and searchWord !=''">
							teacher_name LIKE CONCAT('%',#{searchWord},'%')
						</if>
					</when>
					<when test="searchCategory == 'all'">
						<if test="searchWord != null and searchWord !=''">
							teacher_Id LIKE CONCAT('%',#{searchWord},'%') OR teacher_name LIKE CONCAT('%',#{searchWord},'%')
						</if>
					</when>
					<otherwise>
						<if test="searchWord != null and searchWord !=''">
							teacher_Id LIKE CONCAT('%',#{searchWord},'%')
						</if>
					</otherwise>
				</choose>
			</where>
			ORDER BY teacher_no DESC
			LIMIT #{beginRow}, #{rowPerPage}
	</select>
</mapper>